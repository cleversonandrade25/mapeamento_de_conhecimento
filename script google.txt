function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = JSON.parse(e.postData.contents);
  
  // Cabeçalho fixo: Nome, RE, Nota, Tempo Total, Data
  var linha = [
    data.nome, 
    data.re, 
    data.nota,
    data.tempo_total,
    new Date()
  ];
  
  // Para cada uma das 10 questões, adiciona 3 colunas: Texto da Pergunta, Resposta dada, Acertou?
  data.detalhes.forEach(function(item) {
    linha.push(item.pergunta);
    linha.push(item.escolha);
    linha.push(item.status);
  });
  
  sheet.appendRow(linha);
  
  return ContentService.createTextOutput("Sucesso").setMimeType(ContentService.MimeType.TEXT);
}